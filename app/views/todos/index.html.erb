<h1>Todos</h1>

<h2>My todos</h2>

<% current_user.todos.each do |todo| %>
  <div class="todo">
    <div class="tags">
      <% todo.tag_list.each do |tag| %>
        <span class="tag"><%= tag %></span>
      <% end %>
    </div>
    <span class="detail"><%= todo.detail %></span>

    <div class="reactions">
      <% todo.reactions.group('reactions.emoji').sum('1').each do |emoji, count| %>
      <div class="reaction">
        <span class="emoji" data-todo-id="<%= todo.id %>" data-emoji="<%= emoji %>"><%= emoji %></span> <span class="count"><%= count %></span>
      </div>
      <% end %>
      <div class="reaction add-reaction" data-todo-id="<%= todo.id %>">
        +
      </div>
    </div>
    <div class="comments">
      <% todo.comments.each do |comment| %>
        <div class="comment">
          <span style="color: #<%= comment.user.color %>"><%= comment.user.username %></span> &ndash; <%= comment.content %>
        </div>
      <% end %>
      <div class="comment add-comment">
        <%= form_for [todo, Comment.new] do |f| %>
          <%= f.text_field :content %>
          <%= f.button :submit %>
        <% end %>
      </div>
    </div>
  </div>
<% end %>


<div id="picker"></div>
